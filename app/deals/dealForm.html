<form class='deal-form-control' ng-submit="myForm.$valid && submit()" name="myForm" novalidate>
    <div class="row">
        <div class="col-md-6">
            <strong>Document Number:</strong>
            <text class="pull-right">{{dealForm['ID']}}</text>
            <br/>
            <br/>
            <div class="form-inline" ng-class="{'has-error': myForm['essential Deal Name'].$invalid}">
                <label>Deal Name:</label>
                <span style="color:red" ng-if="getField('essential', 'Deal Name').required">*</span>
                <input type="text" name="essential Deal Name" class="form-control input-sm pull-right" ng-model="dealForm.essential['Deal Name']"
                    ng-required="getField('essential', 'Deal Name').required" uib-tooltip="{{getTooltipMessage(myForm['essential Deal Name'])}}" tooltip-enable="{{myForm['essential Deal Name'].$invalid}}">
            </div>
            <br/>
            <div class="form-inline" ng-class="{'has-error': myForm['essential Due Date'].$invalid}">
                <label>Due Date:</label>
                <span style="color:red" ng-if="getField('essential', 'Due Date').required">*</span>
                <div class="input-group pull-right">
                    <input type="text" name="essential Due Date" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['essential']['Due Date']"
                        class="form-control input-sm" ng-model="dealForm.essential['Due Date']" ng-required="getField('essential', 'Due Date').required"
                        uib-tooltip="{{getTooltipMessage(myForm['essential Due Date'])}}" tooltip-enable="{{myForm['essential Due Date'].$invalid}}"
                        placeholder="{{DATE_FORMAT | uppercase }}">
                    <span class="input-group-btn">
                        <button type="button" class="btn btn-default btn-sm" ng-click="opened['essential']['Due Date'] = true">
                            <span class="glyphicon glyphicon-calendar"></span>
                        </button>
                    </span>
                </div>
            </div>
            <br/>
            <div class="form-inline" ng-class="{'has-error': myForm['essential Assignee'].$invalid}">
                <label>Assignee:</label>
                <span style="color:red" ng-if="getField('essential', 'Assignee').required">*</span>
                <select class="form-control input-sm pull-right" name="essential Assignee" ng-model="dealForm.essential['Assignee']" ng-required="getField('essential', 'Assignee').required"
                uib-tooltip="{{getTooltipMessage(myForm['essential Assignee'])}}" tooltip-enable="{{myForm['essential Assignee'].$invalid}}">
                    <option value="">- select -</option>
                    <!-- /*
                    * START Francis Nash Jasmin 2022/02/10
                    * 
                    * Fixed bug where user appears as blank when no first name or last name is given.
                    * 
                    */ -->
                    <option ng-repeat="user in users" value="{{user.email}}">                        
                        {{(user.firstName !== undefined || user.lastName !== undefined) ? user.firstName + ' ' + user.lastName : user.nickname}}
                    </option>
                    <!-- /*  END Francis Nash Jasmin 2022/02/11 */ -->
                </select>
            </div>
        </div>
        <div class="col-md-4">
            <!-- <div class="input-group" ng-show="showUpload">
                <label>Upload File to fill form</label>
                <input type="file" class="form-control input-sm" id="newDealFile" accept="application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                    />
            </div> -->
            <button type="submit" class="btn btn-success pull-right" ng-disabled="myForm.$invalid">Submit</button>
        </div>
    </div>
    <hr class="dealsCollapsible">
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-10">
            <div class="panel-heading">
                <h4 class="accordion-toggle profileSection" data-toggle="collapse" data-parent="#accordion" data-target="#profileSection">
                    <span class="glyphicon glyphicon-chevron-down">&nbsp;</span>Profile</h4>
            </div>
            <div id="profileSection" class="collapse in">
                <div class="col-md-6">
                    <table class="table table-hover table-condensed">
                        <tbody>
                            <tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile Country'].$invalid}">
                                        <label>Country</label>
                                        <span style="color:red" ng-if="getField('profile', 'Country').required">*</span>
                                        <select class="form-control input-sm pull-right" name="profile Country" ng-model="dealForm.profile['Country']" ng-required="getField('profile', 'Country').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['profile Country'])}}" tooltip-enable="{{myForm['profile Country'].$invalid}}">
                                            <option value="">- select -</option>
                                            <option ng-repeat="option in getField('profile', 'Country').options" value="{{option}}">
                                                {{option}}
                                            </option>
                                        </select>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile Client'].$invalid}">
                                        <label>Client</label>
                                        <span style="color:red" ng-if="getField('profile', 'Client').required">*</span>
                                        <select class="form-control input-sm pull-right" name="profile Client" ng-model="dealForm.profile['Client']" ng-required="getField('profile', 'Client').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['profile Client'])}}" tooltip-enable="{{myForm['profile Client'].$invalid}}">
                                            <option value="">- select -</option>
                                            <option ng-repeat="client in clients" value="{{client.cmpnyNameShort}}">{{client.cmpnyNameShort}}</option>
                                        </select>
                                    </div>
                                </td>
                            </tr>

                            <!-- Business unit -->
                            <!--<tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile businessUnit'].$invalid}">
                                        <label>Business Unit</label>
                                        <span style="color:red" ng-if="getField('profile', 'businessUnit').required">*</span>
                                        <select class="form-control input-sm pull-right" name="profile businessUnit" ng-model="dealForm.profile['businessUnit']" ng-required="getField('profile', 'businessUnit').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['profile businessUnit'])}}" tooltip-enable="{{myForm['profile businessUnit'].$invalid}}">
                                            <option value="">- select -</option>
                                            <option ng-repeat="client in clients" value="{{client.cmpnyNameShort}}">{{client.cmpnyNameShort}}</option>
                                        </select>
                                    </div>
                                </td>
                            </tr>-->

                            <tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile Service'].$invalid}">
                                        <label>Service</label>
                                        <span style="color:red" ng-if="getField('profile', 'Service').required">*</span>
                                        <select class="form-control input-sm pull-right" name="profile Service" ng-model="dealForm.profile['Service']" ng-required="getField('profile', 'Service').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['profile Service'])}}" tooltip-enable="{{myForm['profile Service'].$invalid}}">
                                            <option value="">- select -</option>
                                            <option ng-repeat="option in getField('profile', 'Service').options" value="{{option}}">
                                                {{option}}
                                            </option>
                                        </select>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile Type'].$invalid}">
                                        <label>Type</label>
                                        <span style="color:red" ng-if="getField('profile', 'Type').required">*</span>
                                        <select class="form-control input-sm pull-right" name="profile Type" ng-model="dealForm.profile['Type']" ng-required="getField('profile', 'Type').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['profile Type'])}}" tooltip-enable="{{myForm['profile Type'].$invalid}}">
                                            <option value="">- select -</option>
                                            <option ng-repeat="option in getField('profile', 'Type').options" value="{{option}}">
                                                {{option}}
                                            </option>
                                        </select>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <!-- /*
                                    * START Francis Nash Jasmin 2022/02/04
                                    * 
                                    * Displays numeric input as comma-separated in the deals form.
                                    * 
                                    */ -->
                                    <label>Resource</label>
                                    <span style="color:red" ng-if="getField('profile', 'Resource Size (MM)').required">*</span>
                                    <div class="pull-right">
                                        <div class="form-inline" ng-class="{'has-error': myForm['profile Resource Size (MM)'].$invalid}">
                                            <input type="text" ng-model="dealForm.profile['Resource Size (MM)']" min="0" max="9999" step="0.01" class="form-control input-sm"
                                                name="profile Resource Size (MM)" ng-required="getField('profile', 'Resource Size (MM)').required"
                                                uib-tooltip="{{getTooltipMessage(myForm['profile Resource Size (MM)'])}}" tooltip-enable="{{myForm['profile Resource Size (MM)'].$invalid}}"
                                                number-input
                                                ng-maxlength="9"
                                                > (MM)
                                        </div>
                                        /
                                        <br/>
                                        <div class="form-inline" ng-class="{'has-error': myForm['profile Resource Size (FTE)'].$invalid}">
                                            <input type="text" min="0" step="1" max="9999" class="form-control input-sm" name="profile Resource Size (FTE)" ng-model="dealForm.profile['Resource Size (FTE)']"
                                                ng-required="getField('profile', 'Resource Size (FTE)').required"
                                                uib-tooltip="{{getTooltipMessage(myForm['profile Resource Size (FTE)'])}}" tooltip-enable="{{myForm['profile Resource Size (FTE)'].$invalid}}"
                                                number-input
                                                ng-maxlength="9"
                                                > (FTE)
                                        </div>
                                    </div>
                                    <!-- /*  END Francis Nash Jasmin 2022/02/08 */  -->
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile Duration (Start)'].$invalid}">
                                        <label>Duration (Start)</label>
                                        <span style="color:red" ng-if="getField('profile', 'Duration (Start)').required">*</span>
                                        <div class="input-group pull-right">
                                            <input type="text" name="profile Duration (Start)" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['profile']['Duration (Start)']"
                                                class="form-control input-sm" ng-model="dealForm.profile['Duration (Start)']" ng-required="getField('profile', 'Duration (Start)').required"
                                                uib-tooltip="{{getTooltipMessage(myForm['profile Duration (Start)'])}}" tooltip-enable="{{myForm['profile Duration (Start)'].$invalid}}"
                                                placeholder="{{DATE_FORMAT | uppercase }}">
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default btn-sm" ng-click="opened['profile']['Duration (Start)'] = true">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>AWS Resp (Sales)</label>
                                    <span style="color:red" ng-if="getField('profile', 'AWS Resp (Sales) person').required">*</span>
                                    <div class="pull-right">
                                        <div class="form-inline" ng-class="{'has-error': myForm['profile AWS Resp (Sales) person'].$invalid}">
                                            <select class="form-control input-sm" ng-model="dealForm.profile['AWS Resp (Sales) person']" name="profile AWS Resp (Sales) person"
                                                ng-required="getField('profile', 'AWS Resp (Sales) person').required" ng-change="setSalesBU()"
                                                uib-tooltip="{{getTooltipMessage(myForm['profile AWS Resp (Sales) person'])}}" tooltip-enable="{{myForm['profile AWS Resp (Sales) person'].$invalid}}">
                                                <option value="">- select -</option>
                                                <!-- /*
                                                * START Francis Nash Jasmin 2022/02/10
                                                * 
                                                * Fixed bug where user appears as blank when no first name or last name is given.
                                                * 
                                                */ -->
                                                <option ng-repeat="user in users" value="{{user.email}}">
                                                    {{(user.firstName !== undefined || user.lastName !== undefined) ? user.firstName + ' ' + user.lastName : user.nickname}}
                                                </option>
                                                <!-- /*  END Francis Nash Jasmin 2022/02/11 */ -->
                                            </select>
                                        </div>
                                        /
                                        <br/>
                                        <div class="form-inline" ng-class="{'has-error': myForm['profile AWS Resp (Sales) BU'].$invalid}">
                                            <select class="form-control input-sm" ng-model="dealForm.profile['AWS Resp (Sales) BU']" name="profile AWS Resp (Sales) BU" ng-required="getField('profile', 'AWS Resp (Sales) BU').required"
                                            uib-tooltip="{{getTooltipMessage(myForm['profile AWS Resp (Sales) BU'])}}" tooltip-enable="{{myForm['profile AWS Resp (Sales) BU'].$invalid}}">
                                                <option value="">- select -</option>
                                                <option ng-repeat="businessUnit in salesBU" value="{{businessUnit.BU}}">{{businessUnit.BU}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile Key Assignment'].$invalid}">
                                        <label>Key Assignment</label>
                                        <span style="color:red" ng-if="getField('profile', 'Key Assignment').required">*</span>
                                        <!-- /*
                                        * START Francis Nash Jasmin 2022/02/17
                                        * 
                                        * Added character limit of 50 in input text field.
                                        * 
                                        */ -->
                                        <textarea class="form-control input-sm pull-right" name="profile Key Assignment" ng-model="dealForm.profile['Key Assignment']" ng-required="getField('profile', 'Key Assignment').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['profile Key Assignment'])}}" tooltip-enable="{{myForm['profile Key Assignment'].$invalid}}" maxlength="50"></textarea>
                                        <!-- /*  END Francis Nash Jasmin 2022/02/17 */ -->
                                    </div>
                                </td>
                            </tr>
                            <tr ng-repeat="field in fields.profile track by field.id">
                                <td ng-if="$even && !field.default">
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile ' + field.name].$invalid}">
                                        <label for="{{field.name}}"> {{field.name}} </label>
                                        <span style="color:red" ng-if="field.required">*</span>
                                        <div ng-if="field.type === 'text' || field.type === 'number' || field.type === 'password' || field.type === 'email'" class="pull-right">
                                            <input type="{{field.type}}" class="form-control input-sm" name="{{'profile ' + field.name}}" ng-model="dealForm.profile[field.name]"
                                                ng-required="{{field.required}}" uib-tooltip="{{getTooltipMessage(myForm['profile ' + field.name])}}" tooltip-enable="{{myForm['profile ' + field.name].$invalid}}"/>
                                        </div>
                                        <div ng-if="field.type === 'date'" class="input-group pull-right">
                                            <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['profile'][field.name]" class="form-control input-sm pull-right"
                                                name="{{'profile ' + field.name}}" ng-model="dealForm.profile[field.name]" ng-required="{{field.required}}"
                                                uib-tooltip="{{getTooltipMessage(myForm['profile ' + field.name])}}" tooltip-enable="{{myForm['profile ' + field.name].$invalid}}"
                                                placeholder="{{DATE_FORMAT | uppercase }}">
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default btn-sm" ng-click="opened['profile'][field.name] = true">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </button>
                                            </span>
                                        </div>
                                        <div ng-if="field.type === 'textarea'" class="pull-right">
                                            <!-- show text area -->
                                            <textarea ng-model="dealForm.profile[field.name]" class="form-control input-sm" name="{{'profile ' + field.name}}" ng-required="{{field.required}}"
                                                rows="4" cols="50" uib-tooltip="{{getTooltipMessage(myForm['profile ' + field.name])}}" tooltip-enable="{{myForm['profile ' + field.name].$invalid}}"></textarea>
                                        </div>
                                        <div ng-if="field.type ==='dropdown'" class="pull-right">
                                            <!-- show dropdown -->
                                            <select class="form-control input-sm" name="{{'profile ' + field.name}}" ng-model="dealForm.profile[field.name]" ng-required="{{field.required}}"
                                            uib-tooltip="{{getTooltipMessage(myForm['profile ' + field.name])}}" tooltip-enable="{{myForm['profile ' + field.name].$invalid}}">
                                                <option value="">- select -</option>
                                                <option ng-repeat="option in field.options" value="{{option}}">{{option}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-md-6 form-inline">
                    <table class="table table-hover table-condensed">
                        <tbody>
                            <tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile Division'].$invalid}">
                                        <label>Division</label>
                                        <span style="color:red" ng-if="getField('profile', 'Division').required">*</span>
                                        <select class="form-control input-sm pull-right" ng-model="dealForm.profile['Division']" name="profile Division" 
                                        ng-required="getField('profile', 'Division').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['profile Division'])}}" tooltip-enable="{{myForm['profile Division'].$invalid}}">
                                            <option value="">- select -</option>
                                            <option ng-repeat="option in getField('profile', 'Division').options" value="{{option}}">
                                                {{option}}
                                            </option>
                                        </select>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['businessUnit businessUnits.BU'].$invalid}">
                                        <label>SD</label>
                                        <span style="color:red" ng-if="getField('profile', 'businessUnit').required">*</span>
                                        <select class="form-control input-sm pull-right"  name="businessUnit businessUnits.BU" ng-model="dealForm.profile['SD']" ng-required="getField('profile', 'businessUnit').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['businessUnit businessUnits.BU'])}}" tooltip-enable="{{myForm['businessUnit businessUnits.BU'].$invalid}}">
                                            <option value="">- select -</option>
                                            <!-- <option ng-repeat="businessUnit in businessUnits | 
                                            filter: (dealForm.profile['Division']) | orderBy:'BU'" value="{{businessUnit}}" ng-hide="businessUnit.BU === 'ALL'" >{{businessUnit.BU}}</option> -->
                                          <option ng-hide="businessUnit.BU === 'ALL'" ng-repeat="businessUnit in businessUnits | orderBy:'BU'" value="{{businessUnit.BU}}">{{businessUnit.BU}}</option> 
                                        </select>
                                    </div>
                                </td>
                            </tr>     
                            <tr>
                            <tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile Client Resp'].$invalid}">
                                        <label>Client Resp</label>
                                        <span style="color:red" ng-if="getField('profile', 'Client Resp').required">*</span>
                                        <!-- /*
                                        * START Francis Nash Jasmin 2022/02/17
                                        * 
                                        * Added character limit of 50 in input text field.
                                        * 
                                        */ -->
                                        <input type="text" class="form-control input-sm pull-right" name="profile Client Resp" ng-model="dealForm.profile['Client Resp']"
                                            ng-required="getField('profile', 'Client Resp').required"
                                            uib-tooltip="{{getTooltipMessage(myForm['profile Client Resp'])}}" tooltip-enable="{{myForm['profile Client Resp'].$invalid}}"
                                            maxlength="50">
                                        <!-- /*  END Francis Nash Jasmin 2022/02/17 */ -->
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>Level / Step</label>
                                    <span style="color:red" ng-if="getField('profile', 'Level').required">*</span>
                                    <div class="form-inline pull-right">
                                        <div class="form-group" ng-class="{'has-error': myForm['profile Level'].$invalid}">
                                            <select class="form-control input-sm" ng-model="dealForm.profile['Level']" name="profile Level" ng-required="getField('profile', 'Level').required"
                                            uib-tooltip="{{getTooltipMessage(myForm['profile Level'])}}" tooltip-enable="{{myForm['profile Level'].$invalid}}">
                                                <option value="">- select -</option>
                                                <option ng-repeat="option in getField('profile', 'Level').options" value="{{option}}">{{option}}</option>
                                            </select>
                                        </div>
                                        /
                                        <div class="form-group" ng-class="{'has-error': myForm['profile Step'].$invalid}">
                                            <select class="form-control input-sm" ng-model="dealForm.profile['Step']" name="profile Step" ng-required="getField('profile', 'Step').required"
                                            uib-tooltip="{{getTooltipMessage(myForm['profile Step'])}}" tooltip-enable="{{myForm['profile Step'].$invalid}}">
                                                <option value="">- select -</option>
                                                <!-- /*
                                                * START Francis Nash Jasmin 2022/02/21
                                                * 
                                                * Display the Japanese equivalent of the step code.
                                                * 
                                                */ -->
                                                <option ng-repeat="option in getField('profile', 'Step').options | 
                                                        filter: (dealForm.profile['Level'] + '.')" value="{{option}}">{{option}}:{{getStepJA(option)}}</option>
                                                <!-- /* END Francis Nash Jasmin 2022/02/21 */ -->
                                            </select>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile Confidence'].$invalid}">
                                        <label>Confidence</label>
                                        <span style="color:red" ng-if="getField('profile', 'Confidence').required">*</span>
                                        <select class="form-control input-sm pull-right" ng-model="dealForm.profile['Confidence']" name="profile Confidence" ng-required="getField('profile', 'Confidence').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['profile Confidence'])}}" tooltip-enable="{{myForm['profile Confidence'].$invalid}}">
                                            <option value="">- select -</option>
                                            <option ng-repeat="option in getField('profile', 'Confidence').options" value="{{option}}">
                                                {{option}}
                                            </option>
                                        </select>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>Revenue</label>
                                    <span style="color:red" ng-if="getField('profile', 'Revenue').required">*</span>
                                    <div class="form-inline pull-right" ng-class="{'has-error': myForm['profile Revenue'].$invalid}">
                                        <input type="number" min="0" step="1" class="form-control input-sm" name="profile Revenue" ng-model="dealForm.profile['Revenue']"
                                            ng-required="getField('profile', 'Revenue').required"
                                            uib-tooltip="{{getTooltipMessage(myForm['profile Revenue'])}}" tooltip-enable="{{myForm['profile Revenue'].$invalid}}" readonly> (JPY)
                                    </div>
                                    <br/>
                                    <br/>
                                    <label>CM</label>
                                    <span style="color:red" ng-if="getField('profile', 'CM').required">*</span>
                                    <div class="form-inline pull-right" ng-class="{'has-error': myForm['profile CM'].$invalid}">
                                        <input type="number" min="0" step="1" class="form-control input-sm" name="profile CM" ng-model="dealForm.profile['CM']" ng-required="getField('profile', 'CM').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['profile CM'])}}" tooltip-enable="{{myForm['profile CM'].$invalid}}" readonly> (JPY)
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile Duration (End)'].$invalid}">
                                        <label>Duration (End)</label>
                                        <span style="color:red" ng-if="getField('profile', 'Duration (End)').required">*</span>
                                        <div class="input-group pull-right">
                                            <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['profile']['Duration (End)']" class="form-control input-sm"
                                                name="profile Duration (End)" ng-model="dealForm.profile['Duration (End)']" ng-required="getField('profile', 'Duration (End)').required"
                                                uib-tooltip="{{getTooltipMessage(myForm['profile Duration (End)'])}}" tooltip-enable="{{myForm['profile Duration (End)'].$invalid}}"
                                                placeholder="{{DATE_FORMAT | uppercase }}">
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default btn-sm" ng-click="opened['profile']['Duration (End)'] = true">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>AWS Resp (Dev)</label>
                                    <span style="color:red" ng-if="getField('profile', 'AWS Resp (Dev) person').required">*</span>
                                    <div class="pull-right">
                                        <div class="form-group" ng-class="{'has-error': myForm['profile AWS Resp (Dev) person'].$invalid}">
                                            <select class="form-control input-sm" name="profile AWS Resp (Dev) person" ng-model="dealForm.profile['AWS Resp (Dev) person']" ng-required="getField('profile', 'AWS Resp (Dev) person').required"
                                            uib-tooltip="{{getTooltipMessage(myForm['profile AWS Resp (Dev) person'])}}" tooltip-enable="{{myForm['profile AWS Resp (Dev) person'].$invalid}}" ng-change="setDevBU()" >
                                                <option value="">- select -</option>
                                                <!-- /*
                                                * START Francis Nash Jasmin 2022/02/10
                                                * 
                                                * Fixed bug where user appears as blank when no first name or last name is given.
                                                * 
                                                */ -->
                                                <option ng-repeat="user in users" value="{{user.email}}">
                                                    {{(user.firstName !== undefined || user.lastName !== undefined) ? user.firstName + ' ' + user.lastName : user.nickname}}
                                                </option>
                                                <!-- /*  END Francis Nash Jasmin 2022/02/11 */ -->
                                            </select>
                                        </div>
                                        <br/> /
                                        <br/>
                                        <div class="form-group" ng-class="{'has-error': myForm['profile AWS Resp (Dev) BU'].$invalid}">
                                            <select class="form-control input-sm" name="profile AWS Resp (Dev) BU" ng-model="dealForm.profile['AWS Resp (Dev) BU']" ng-required="getField('profile', 'AWS Resp (Dev) BU').required"
                                            uib-tooltip="{{getTooltipMessage(myForm['profile AWS Resp (Dev) BU'])}}" tooltip-enable="{{myForm['profile AWS Resp (Dev) BU'].$invalid}}">
                                                <option value="">- select -</option>
                                                <option ng-repeat="businessUnit in devBU" value="{{businessUnit.BU}}">{{businessUnit.BU}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>Remark</label>
                                    <span style="color:red" ng-if="getField('profile', 'Remark').required">*</span>
                                    <div class="form-group pull-right" ng-class="{'has-error': myForm['profile Remark'].$invalid}">
                                        <!-- /*
                                        * START Francis Nash Jasmin 2022/02/17
                                        * 
                                        * Added character limit of 50 in input text field.
                                        * 
                                        */ -->
                                        <input type="text" class="form-control input-sm" name="profile Remark" ng-model="dealForm.profile['Remark']" ng-required="getField('profile', 'Remark').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['profile Remark'])}}" tooltip-enable="{{myForm['profile Remark'].$invalid}}"
                                        maxlength="50">
                                        <!-- /*  END Francis Nash Jasmin 2022/02/17 */ -->
                                    </div>
                                </td>
                            </tr>
                            <tr ng-repeat="field in fields.profile track by field.id">
                                <td ng-if="$odd && !field.default">
                                    <div class="form-inline" ng-class="{'has-error': myForm['profile ' + field.name].$invalid && myForm['profile ' + field.name].$touched}">
                                        <label for="{{field.name}}"> {{field.name}} </label>
                                        <span style="color:red" ng-if="field.required">*</span>
                                        <div ng-if="field.type === 'text' || field.type === 'number' || field.type === 'password' || field.type === 'email'" class="pull-right">
                                            <input type="{{field.type}}" class="form-control input-sm" name="{{'profile ' + field.name}}" ng-model="dealForm.profile[field.name]"
                                                ng-required="{{field.required}}" uib-tooltip="{{getTooltipMessage(myForm['profile ' + field.name])}}" tooltip-enable="{{myForm['profile ' + field.name].$invalid}}"/>
                                        </div>
                                        <div ng-if="field.type === 'date'" class="input-group pull-right">
                                            <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['profile'][field.name]" class="form-control input-sm" name="{{'profile ' + field.name}}"
                                                ng-model="dealForm.profile[field.name]" ng-required="{{field.required}}" uib-tooltip="{{getTooltipMessage(myForm['profile ' + field.name])}}" tooltip-enable="{{myForm['profile ' + field.name].$invalid}}"
                                                placeholder="{{DATE_FORMAT | uppercase }}">
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default btn-sm" ng-click="opened['profile'][field.name] = true">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </button>
                                            </span>
                                        </div>
                                        <div ng-if="field.type === 'textarea'" class="pull-right">
                                            <!-- show text area -->
                                            <textarea ng-model="dealForm.profile[field.name]" class="form-control input-sm" name="{{'profile ' + field.name}}" ng-required="{{field.required}}"
                                                rows="4" cols="50" uib-tooltip="{{getTooltipMessage(myForm['profile ' + field.name])}}" tooltip-enable="{{myForm['profile ' + field.name].$invalid}}"></textarea>
                                        </div>
                                        <div ng-if="field.type ==='dropdown'" class="pull-right">
                                            <!-- show dropdown -->
                                            <select class="form-control input-sm" ng-model="dealForm.profile[field.name]" name="{{'profile ' + field.name}}" ng-required="{{field.required}}"
                                            uib-tooltip="{{getTooltipMessage(myForm['profile ' + field.name])}}" tooltip-enable="{{myForm['profile ' + field.name].$invalid}}">
                                                <option value="">- select -</option>
                                                <option ng-repeat="option in field.options" value="{{option}}">{{option}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-md-1"></div>
    </div>
    <hr class="dealsCollapsible">
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-10">
            <div class="panel-heading">
                <h4 class="accordion-toggle processSection" data-toggle="collapse" data-parent="#accordion" data-target="#processSection">
                    <span class="glyphicon glyphicon-chevron-down">&nbsp;</span>Process</h4>
            </div>
            <div id="processSection" class="collapse in">
                <div class="col-md-6 form-inline">
                    <table class="table table-hover table-condensed">
                        <tbody>
                            <tr>
                                <td>
                                    <!-- blank row for matching the format -->
                                    <p></p>
                                    <br/>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>SRB No.</label>
                                    <span style="color:red" ng-if="getField('process', 'SRB No').required">*</span>
                                    <div class="form-group pull-right" ng-class="{'has-error': myForm['process SRB No'].$invalid}">
                                        <!-- /*
                                        * START Francis Nash Jasmin 2022/02/17
                                        * 
                                        * Added character limit of 50 in input text field.
                                        * 
                                        */ -->
                                        <input type="text" class="form-control input-sm" name="process SRB No" ng-model="dealForm.process['SRB No']" ng-required="getField('process', 'SRB No').required"
                                            placeholder="(e.g. PS-0095)" uib-tooltip="{{getTooltipMessage(myForm['process SRB No'])}}" tooltip-enable="{{myForm['process SRB No'].$invalid}}"
                                            maxlength="50">
                                        <!-- /*  END Francis Nash Jasmin 2022/02/17 */ -->
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>SRB Date</label>
                                    <span style="color:red" ng-if="getField('process', 'SRB Date').required">*</span>
                                    <div class="input-group pull-right" ng-class="{'has-error': myForm['process SRB Date'].$invalid}">
                                        <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['process']['SRB Date']" class="form-control input-sm" name="process SRB Date"
                                            ng-model="dealForm.process['SRB Date']" ng-required="getField('process', 'SRB Date').required"
                                            uib-tooltip="{{getTooltipMessage(myForm['process SRB Date'])}}" tooltip-enable="{{myForm['process SRB Date'].$invalid}}"
                                            placeholder="{{DATE_FORMAT | uppercase }}">
                                        <span class="input-group-btn">
                                            <button type="button" class="btn btn-default btn-sm" ng-click="opened['process']['SRB Date'] = true">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </button>
                                        </span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>SRB Status</label>
                                    <span style="color:red" ng-if="getField('process', 'SRB Status').required">*</span>
                                    <div class="form-group pull-right" ng-class="{'has-error': myForm['process SRB Status'].$invalid}">
                                        <select class="form-control input-sm" name="process SRB Status" ng-model="dealForm.process['SRB Status']" ng-required="getField('process', 'SRB Status').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['process SRB Status'])}}" tooltip-enable="{{myForm['process SRB Status'].$invalid}}">
                                            <option value="">- select -</option>
                                            <option ng-repeat="option in getField('process', 'SRB Status').options" value="{{option}}">
                                                {{option}}
                                            </option>
                                        </select>
                                    </div>
                                </td>
                            </tr>
                            <tr ng-repeat="field in fields.process track by field.id">
                                <td ng-if="$even && !field.default">
                                    <div class="form-inline" ng-class="{'has-error': myForm['process ' + field.name].$invalid}">
                                        <label for="{{field.name}}"> {{field.name}} </label>
                                        <span style="color:red" ng-if="field.required">*</span>
                                        <div ng-if="field.type === 'text' || field.type === 'number' || field.type === 'password' || field.type === 'email'" class="pull-right">
                                            <input type="{{field.type}}" class="form-control input-sm" name="{{'process ' + field.name}}" ng-model="dealForm.process[field.name]"
                                                ng-required="{{field.required}}" uib-tooltip="{{getTooltipMessage(myForm['process ' + field.name])}}" tooltip-enable="{{myForm['process ' + field.name].$invalid}}" />
                                        </div>
                                        <div ng-if="field.type === 'date'" class="input-group pull-right">
                                            <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['process'][field.name]" class="form-control input-sm" name="{{'process ' + field.name}}"
                                                ng-model="dealForm.process[field.name]" ng-required="{{field.required}}" uib-tooltip="{{getTooltipMessage(myForm['process ' + field.name])}}" tooltip-enable="{{myForm['process ' + field.name].$invalid}}"
                                                placeholder="{{DATE_FORMAT | uppercase }}">
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default btn-sm" ng-click="opened['process'][field.name] = true">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </button>
                                            </span>
                                        </div>
                                        <div ng-if="field.type === 'textarea'" class="pull-right">
                                            <!-- show text area -->
                                            <textarea ng-model="dealForm.process[field.name]" class="form-control input-sm" name="{{'process ' + field.name}}" ng-required="{{field.required}}"
                                                rows="4" cols="50" uib-tooltip="{{getTooltipMessage(myForm['process ' + field.name])}}" tooltip-enable="{{myForm['process ' + field.name].$invalid}}"></textarea>
                                        </div>
                                        <div ng-if="field.type ==='dropdown'" class="pull-right">
                                            <!-- show dropdown -->
                                            <select class="form-control input-sm" name="{{'process ' + field.name}}" ng-model="dealForm.process[field.name]" ng-required="{{field.required}}"
                                            uib-tooltip="{{getTooltipMessage(myForm['process ' + field.name])}}" tooltip-enable="{{myForm['process ' + field.name].$invalid}}">
                                                <option value="">- select -</option>
                                                <option ng-repeat="option in field.options" value="{{option}}">{{option}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-md-6 form-inline">
                    <table class="table table-hover table-condensed">
                        <tbody>
                            <tr>
                                <td>
                                    <label>SOW Scheme</label>
                                    <span style="color:red" ng-if="getField('process', 'SOW Scheme').required">*</span>
                                    <div class="form-group pull-right" ng-class="{'has-error': myForm['process SOW Scheme'].$invalid}">
                                        <select class="form-control input-sm" ng-model="dealForm.process['SOW Scheme']" name="process SOW Scheme" ng-required="getField('process', 'SOW Scheme').required"
                                            ng-change="setContracts(dealForm.process['SOW Scheme'])"
                                            uib-tooltip="{{getTooltipMessage(myForm['process SOW Scheme'])}}" tooltip-enable="{{myForm['process SOW Scheme'].$invalid}}">
                                            <option value="">- select -</option>
                                            <option ng-repeat="option in getField('process', 'SOW Scheme').options" value="{{option}}">
                                                {{option}}
                                            </option>
                                        </select>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>SOW No.</label>
                                    <span style="color:red" ng-if="getField('process', 'SOW No').required">*</span>
                                    <div class="form-group pull-right" ng-class="{'has-error': myForm['process SOW No'].$invalid}">
                                        <!-- /*
                                        * START Francis Nash Jasmin 2022/02/17
                                        * 
                                        * Added character limit of 50 in input text field.
                                        * 
                                        */ -->
                                        <input type="text" class="form-control input-sm" name="process SOW No" ng-model="dealForm.process['SOW No']" ng-required="getField('process', 'SOW No').required"
                                            placeholder="(e.g. AWS-2013-2575)" uib-tooltip="{{getTooltipMessage(myForm['process SOW No'])}}" tooltip-enable="{{myForm['process SOW No'].$invalid}}"
                                            maxlength="50">
                                        <!-- /*  END Francis Nash Jasmin 2022/02/17 */ -->
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>SOW Date</label>
                                    <span style="color:red" ng-if="getField('process', 'SOW Date').required">*</span>
                                    <div class="input-group pull-right" ng-class="{'has-error': myForm['process SOW Date'].$invalid}">
                                        <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['process']['SOW Date']" class="form-control input-sm" name="process SOW Date"
                                            ng-model="dealForm.process['SOW Date']" ng-required="getField('process', 'SOW Date').required"
                                            uib-tooltip="{{getTooltipMessage(myForm['process SOW Date'])}}" tooltip-enable="{{myForm['process SOW Date'].$invalid}}"
                                            placeholder="{{DATE_FORMAT | uppercase }}">
                                        <span class="input-group-btn">
                                            <button type="button" class="btn btn-default btn-sm" ng-click="opened['process']['SOW Date'] = true">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </button>
                                        </span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>SOW Status</label>
                                    <span style="color:red" ng-if="getField('process', 'SOW Status').required">*</span>
                                    <div class="form-group pull-right" ng-class="{'has-error': myForm['process SOW Status'].$invalid}">
                                        <select class="form-control input-sm" name="process SOW Status" ng-model="dealForm.process['SOW Status']" ng-required="getField('process', 'SOW Status').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['process SOW Status'])}}" tooltip-enable="{{myForm['process SOW Status'].$invalid}}">
                                            <option value="">- select -</option>
                                            <option ng-repeat="option in getField('process', 'SOW Status').options" value="{{option}}">
                                                {{option}}
                                            </option>
                                        </select>
                                    </div>
                                </td>
                            </tr>
                            <tr ng-repeat="field in fields.process track by field.id">
                                <td ng-if="$odd && !field.default">
                                    <div class="form-inline" ng-class="{'has-error': myForm['process ' + field.name].$invalid}">
                                        <label for="{{field.name}}"> {{field.name}} </label>
                                        <span style="color:red" ng-if="field.required">*</span>
                                        <div ng-if="field.type === 'text' || field.type === 'number' || field.type === 'password' || field.type === 'email'" class="pull-right">
                                            <input type="{{field.type}}" class="form-control input-sm" name="{{'process ' + field.name}}" ng-model="dealForm.process[field.name]"
                                                ng-required="{{field.required}}" uib-tooltip="{{getTooltipMessage(myForm['process ' + field.name])}}" tooltip-enable="{{myForm['process ' + field.name].$invalid}}"/>
                                        </div>
                                        <div ng-if="field.type === 'date'" class="input-group pull-right">
                                            <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['process'][field.name]" class="form-control input-sm" name="{{'process ' + field.name}}"
                                                ng-model="dealForm.process[field.name]" ng-required="{{field.required}}" uib-tooltip="{{getTooltipMessage(myForm['process ' + field.name])}}" tooltip-enable="{{myForm['process ' + field.name].$invalid}}"
                                                placeholder="{{DATE_FORMAT | uppercase }}">
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default btn-sm" ng-click="opened['process'][field.name] = true">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </button>
                                            </span>
                                        </div>
                                        <div ng-if="field.type === 'textarea'" class="pull-right">
                                            <!-- show text area -->
                                            <textarea ng-model="dealForm.process[field.name]" class="form-control input-sm" name="{{'process ' + field.name}}" ng-required="{{field.required}}"
                                                rows="4" cols="50" uib-tooltip="{{getTooltipMessage(myForm['process ' + field.name])}}" tooltip-enable="{{myForm['process ' + field.name].$invalid}}"></textarea>
                                        </div>
                                        <div ng-if="field.type ==='dropdown'" class="pull-right">
                                            <!-- show dropdown -->
                                            <select class="form-control input-sm" name="{{'process ' + field.name}}" ng-model="dealForm.process[field.name]" ng-required="{{field.required}}"
                                            uib-tooltip="{{getTooltipMessage(myForm['process ' + field.name])}}" tooltip-enable="{{myForm['process ' + field.name].$invalid}}">
                                                <option value="">- select -</option>
                                                <option ng-repeat="option in field.options" value="{{option}}">{{option}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-md-1"></div>
    </div>
    <hr class="dealsCollapsible">
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-10">
            <div class="panel-heading">
                <h4 class="accordion-toggle distributionSection" data-toggle="collapse" data-parent="#accordion" data-target="#distributionSection">
                    <span class="glyphicon glyphicon-chevron-down">&nbsp;</span>Distribution</h4>
            </div>
            <div id="distributionSection" class="collapse in">
                <div class="col-md-3">
                    <label>Input Starting Month:</label>
                    <div class="input-group pull-right">
                        <input type="text" uib-datepicker-popup="yyyy/MM" datepicker-options="{minMode: 'month'}" datepickerMode="'month'" is-open="opened['distribution']['startingMonthYear']"
                            class="form-control input-sm" ng-readonly="true" ng-model="startingMonthYear" show-button-bar="false" required>
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-default btn-sm" ng-click="opened['distribution']['startingMonthYear'] = true">
                                <span class="glyphicon glyphicon-calendar"></span>
                            </button>
                        </span>
                    </div>
                </div>
                <div ng-repeat="contract in contracts">
                    <table class="table table-condensed">
                        <thead>
                            <th>MONTH</th>
                            <th>(
                                <text style="color: red">{{contract}}</text>)</th>
                            <th ng-repeat="monthYear in currentMonths.slice(0, 6)">
                                {{monthYear}}
                            </th>
                        </thead>
                        <tbody>
                            <!-- /*
                            * START Francis Nash Jasmin 2022/02/04
                            * 
                            * Displays numeric input as comma-separated in the deals form.
                            * 
                            */ -->
                            <tr>
                                <td>
                                    <b>Resource (MM):</b>
                                </td>
                                <td>
                                    <b style="color:red">JP</b>
                                    <br/>
                                    <br/>
                                    <b style="color: navy">GD</b>
                                </td>
                                <!-- /*
                                * START Francis Nash Jasmin 2022/02/21
                                * 
                                * Set the alignment of numeric input to the right.
                                * 
                                */ -->
                                <td ng-repeat="monthYear in currentMonths.slice(0, 6)">
                                    <div class="form-group" ng-class="{'has-error': myForm['distribution ' + contract + ' res jp ' + monthYear].$invalid}">
                                        <input type="text" min="0" max="9999" step="1" class="form-control input-sm pull-right" name="{{'distribution ' + contract + ' res jp ' + monthYear}}"
                                            ng-model="dealForm.distribution[contract].res.jp[monthYear]" 
                                            uib-tooltip="{{getTooltipMessage(myForm['distribution ' + contract + ' res jp ' + monthYear])}}" tooltip-enable="{{myForm['distribution ' + contract + ' res jp ' + monthYear].$invalid}}"
                                            number-input
                                            ng-maxlength="9"
                                            style="text-align: right;"
                                            />
                                    </div>
                                    <div class="form-group" ng-class="{'has-error': myForm['distribution ' + contract + ' res gd ' + monthYear].$invalid}">
                                        <input type="text" min="0" max="9999" step="1" class="form-control input-sm pull-right" name="{{'distribution ' + contract + ' res gd ' + monthYear}}"
                                            ng-model="dealForm.distribution[contract].res.gd[monthYear]" 
                                            uib-tooltip="{{getTooltipMessage(myForm['distribution ' + contract + ' res gd ' + monthYear])}}" tooltip-enable="{{myForm['distribution ' + contract + ' res gd ' + monthYear].$invalid}}"
                                            number-input
                                            ng-maxlength="9"
                                            style="text-align: right;"
                                            />
                                    </div>
                                </td>
                                <!-- /*  END Francis Nash Jasmin 2022/02/21 */ -->
                            </tr>
                            <tr>
                                <td>
                                    <b>Revenue (JPY):</b>
                                </td>
                                <td>
                                    <b style="color:red">JP</b>
                                    <br/>
                                    <br/>
                                    <b style="color: navy">GD</b>
                                </td>
                                <!-- /*
                                * START Francis Nash Jasmin 2022/02/21
                                * 
                                * Set the alignment of numeric input to the right.
                                * 
                                */ -->
                                <td ng-repeat="monthYear in currentMonths.slice(0, 6)">
                                    <div class="form-group" ng-class="{'has-error': myForm['distribution ' + contract + ' rev jp ' + monthYear].$invalid}">
                                        <input type="text" min="0" step="1" class="form-control input-sm pull-right" name="{{'distribution ' + contract + ' rev jp ' + monthYear}}"
                                            ng-model="dealForm.distribution[contract].rev.jp[monthYear]" 
                                            uib-tooltip="{{getTooltipMessage(myForm['distribution ' + contract + ' rev jp ' + monthYear])}}" tooltip-enable="{{myForm['distribution ' + contract + ' rev jp ' + monthYear].$invalid}}"
                                            number-input
                                            style="text-align: right;"
                                            />
                                    </div>
                                    <div class="form-group" ng-class="{'has-error': myForm['distribution ' + contract + ' rev gd ' + monthYear].$invalid}">
                                        <input type="text" min="0" step="1" class="form-control input-sm pull-right" name="{{'distribution ' + contract + ' rev gd ' + monthYear}}"
                                            ng-model="dealForm.distribution[contract].rev.gd[monthYear]" 
                                            uib-tooltip="{{getTooltipMessage(myForm['distribution ' + contract + ' rev gd ' + monthYear])}}" tooltip-enable="{{myForm['distribution ' + contract + ' rev gd ' + monthYear].$invalid}}"
                                            number-input
                                            style="text-align: right;"
                                            />
                                    </div>
                                </td>
                                <!-- /*  END Francis Nash Jasmin 2022/02/21 */ -->
                            </tr>
                            <tr>
                                <td>
                                    <b>CM (JPY):</b>
                                </td>
                                <td>
                                    <b style="color: navy">ALL</b>
                                </td>
                                <!-- /*
                                * START Francis Nash Jasmin 2022/02/21
                                * 
                                * Set the alignment of numeric input to the right.
                                * 
                                */ -->
                                <td ng-repeat="monthYear in currentMonths.slice(0, 6)">
                                    <div class="form-group" ng-class="{'has-error': myForm['distribution ' + contract + ' cm ' + monthYear].$invalid}">
                                        <input type="text" min="0" step="1" class="form-control input-sm pull-right" name="{{'distribution ' + contract + ' cm ' + monthYear}}"
                                            ng-model="dealForm.distribution[contract].cm[monthYear]" 
                                            uib-tooltip="{{getTooltipMessage(myForm['distribution ' + contract + ' cm ' + monthYear])}}" tooltip-enable="{{myForm['distribution ' + contract + ' cm ' + monthYear].$invalid}}"
                                            number-input
                                            style="text-align: right;"
                                            />
                                    </div>
                                </td>
                                <!-- /*  END Francis Nash Jasmin 2022/02/21 */ -->
                            </tr>
                            <!-- /*  END Francis Nash Jasmin 2022/02/11 */ -->
                        </tbody>
                    </table>
                    <table class="table table-condensed">
                        <thead>
                            <th>MONTH</th>
                            <th>(
                                <text style="color: red">{{contract}}</text>)</th>
                            <th ng-repeat="monthYear in currentMonths.slice(6, 12)">
                                {{monthYear}}
                            </th>
                        </thead>
                        <tbody>
                            <!-- /*
                            * START Francis Nash Jasmin 2022/02/04
                            * 
                            * Displays numeric input as comma-separated in the deals form.
                            * 
                            */ -->
                            <tr>
                                <td>
                                    <b>Resource (MM):</b>
                                </td>
                                <td>
                                    <b style="color:red">JP</b>
                                    <br/>
                                    <br/>
                                    <b style="color: navy">GD</b>
                                </td>
                                <!-- /*
                                * START Francis Nash Jasmin 2022/02/21
                                * 
                                * Set the alignment of numeric input to the right.
                                * 
                                */ -->
                                <td ng-repeat="monthYear in currentMonths.slice(6, 12)">
                                    <div class="form-group" ng-class="{'has-error': myForm['distribution ' + contract + ' res jp ' + monthYear].$invalid}">
                                        <input type="text" min="0" max="9999" step="1" class="form-control input-sm pull-right" name="{{'distribution ' + contract + ' res jp ' + monthYear}}"
                                            ng-model="dealForm.distribution[contract].res.jp[monthYear]" 
                                            uib-tooltip="{{getTooltipMessage(myForm['distribution ' + contract + ' res jp ' + monthYear])}}" tooltip-enable="{{myForm['distribution ' + contract + ' res jp ' + monthYear].$invalid}}"
                                            number-input
                                            ng-maxlength="9"
                                            style="text-align: right;"
                                            />
                                    </div>
                                    <div class="form-group" ng-class="{'has-error': myForm['distribution ' + contract + ' res gd ' + monthYear].$invalid}">
                                        <input type="text" min="0" max="9999" step="1" class="form-control input-sm pull-right" name="{{'distribution ' + contract + ' res gd ' + monthYear}}"
                                            ng-model="dealForm.distribution[contract].res.gd[monthYear]" 
                                            uib-tooltip="{{getTooltipMessage(myForm['distribution ' + contract + ' res gd ' + monthYear])}}" tooltip-enable="{{myForm['distribution ' + contract + ' res gd ' + monthYear].$invalid}}"
                                            number-input
                                            ng-maxlength="9"
                                            style="text-align: right;"
                                            />
                                    </div>
                                </td>
                                <!-- /*  END Francis Nash Jasmin 2022/02/21 */ -->
                            </tr>
                            <tr>
                                <td>
                                    <b>Revenue (JPY):</b>
                                </td>
                                <td>
                                    <b style="color:red">JP</b>
                                    <br/>
                                    <br/>
                                    <b style="color: navy">GD</b>
                                </td>
                                <!-- /*
                                * START Francis Nash Jasmin 2022/02/21
                                * 
                                * Set the alignment of numeric input to the right.
                                * 
                                */ -->
                                <td ng-repeat="monthYear in currentMonths.slice(6, 12)">
                                    <div class="form-group" ng-class="{'has-error': myForm['distribution ' + contract + ' rev jp ' + monthYear].$invalid}">
                                        <input type="text" min="0" step="1" class="form-control input-sm pull-right" name="{{'distribution ' + contract + ' rev jp ' + monthYear}}"
                                            ng-model="dealForm.distribution[contract].rev.jp[monthYear]" 
                                            uib-tooltip="{{getTooltipMessage(myForm['distribution ' + contract + ' rev jp ' + monthYear])}}" tooltip-enable="{{myForm['distribution ' + contract + ' rev jp ' + monthYear].$invalid}}"
                                            number-input
                                            style="text-align: right;"
                                            />
                                    </div>
                                    <div class="form-group" ng-class="{'has-error': myForm['distribution ' + contract + ' rev gd ' + monthYear].$invalid}">
                                        <input type="text" min="0" step="1" class="form-control input-sm pull-right" name="{{'distribution ' + contract + ' rev gd ' + monthYear}}"
                                            ng-model="dealForm.distribution[contract].rev.gd[monthYear]" 
                                            uib-tooltip="{{getTooltipMessage(myForm['distribution ' + contract + ' rev gd ' + monthYear])}}" tooltip-enable="{{myForm['distribution ' + contract + ' rev gd ' + monthYear].$invalid}}"
                                            number-input
                                            style="text-align: right;"
                                            />
                                    </div>
                                </td>
                                <!-- /*  END Francis Nash Jasmin 2022/02/21 */ -->
                            </tr>
                            <tr>
                                <td>
                                    <b>CM (JPY):</b>
                                </td>
                                <td>
                                    <b style="color: navy">ALL</b>
                                </td>
                                <!-- /*
                                * START Francis Nash Jasmin 2022/02/21
                                * 
                                * Set the alignment of numeric input to the right.
                                * 
                                */ -->
                                <td ng-repeat="monthYear in currentMonths.slice(6, 12)">
                                    <div class="form-group" ng-class="{'has-error': myForm['distribution ' + contract + ' cm ' + monthYear].$invalid && myForm['distribution ' + contract + ' cm ' + monthYear].$touched}">
                                        <input type="text" min="0" step="1" class="form-control input-sm pull-right" name="{{'distribution ' + contract + ' cm ' + monthYear}}"
                                            ng-model="dealForm.distribution[contract].cm[monthYear]" 
                                            uib-tooltip="{{getTooltipMessage(myForm['distribution ' + contract + ' cm ' + monthYear])}}" tooltip-enable="{{myForm['distribution ' + contract + ' cm ' + monthYear].$invalid}}"
                                            number-input
                                            style="text-align: right;"
                                            />
                                    </div>
                                </td>
                                <!-- /*  END Francis Nash Jasmin 2022/02/21 */ -->
                            </tr>
                            <!-- /*  END Francis Nash Jasmin 2022/02/11 */ -->
                        </tbody>
                    </table>
                    <div class="row">
                        <div class="col-md-3"></div>
                        <div class="col-md-4"></div>
                        <div class="col-md-5">
                            <table class="table table-condensed">
                                <tr class="active">
                                    <th>Total</th>
                                    <td>{{total[contract][currentFiscalYear.years].resource}} <text class="pull-right">(MM)</text></td>
                                    <td>{{total[contract][currentFiscalYear.years].revenue}} <text class="pull-right">(JPY)</text></td>
                                </tr>
                                <tr class="active">
                                    <th>Average</th>
                                    <td></td>
                                    <td>{{total[contract][currentFiscalYear.years].average | number: 3}} <text class="pull-right">(JPY/MM)</text></td>
                                </tr>
                                <tr class="active">
                                    <th>CM</th>
                                    <td>{{total[contract][currentFiscalYear.years].cm}} <text class="pull-right">(JPY)</text></td>
                                    <td>{{total[contract][currentFiscalYear.years].percent | number: 1}} <text class="pull-right">(%)</text></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 form-inline">
                        <table class="table table-hover table-condensed">
                            <tbody>
                                <tr ng-repeat="field in fields.distribution track by field.id">
                                    <td ng-if="$even">
                                        <div class="form-inline" ng-class="{'has-error': myForm['distribution ' + field.name].$invalid}">
                                            <label for="{{field.name}}"> {{field.name}} </label>
                                            <span style="color:red" ng-if="field.required">*</span>
                                            <div ng-if="field.type === 'text' || field.type === 'number' || field.type === 'password' || field.type === 'email'" class="pull-right">
                                                <input type="{{field.type}}" class="form-control input-sm" name="{{'distribution ' + field.name}}" ng-model="dealForm.distribution[field.name]"
                                                    ng-required="{{field.required}}" 
                                                    uib-tooltip="{{getTooltipMessage(myForm['distribution ' + field.name])}}" tooltip-enable="{{myForm['distribution ' + field.name].$invalid}}"/>
                                            </div>
                                            <div ng-if="field.type === 'date'" class="input-group pull-right">
                                                <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['distribution'][field.name]" class="form-control input-sm"
                                                    name="{{'distribution ' + field.name}}" ng-model="dealForm.distribution[field.name]"
                                                    ng-required="{{field.required}}"
                                                    uib-tooltip="{{getTooltipMessage(myForm['distribution ' + field.name])}}" tooltip-enable="{{myForm['distribution ' + field.name].$invalid}}"
                                                    placeholder="{{DATE_FORMAT | uppercase }}">
                                                <span class="input-group-btn">
                                                    <button type="button" class="btn btn-default btn-sm" ng-click="opened['distribution'][field.name] = true">
                                                        <span class="glyphicon glyphicon-calendar"></span>
                                                    </button>
                                                </span>
                                            </div>
                                            <div ng-if="field.type === 'textarea'" class="pull-right">
                                                <!-- show text area -->
                                                <textarea ng-model="dealForm.distribution[field.name]" name="{{'distribution ' + field.name}}" class="form-control input-sm" ng-required="{{field.required}}"
                                                    rows="4" cols="50" uib-tooltip="{{getTooltipMessage(myForm['distribution ' + field.name])}}" tooltip-enable="{{myForm['distribution ' + field.name].$invalid}}"></textarea>
                                            </div>
                                            <div ng-if="field.type ==='dropdown'" class="pull-right">
                                                <!-- show dropdown -->
                                                <select class="form-control input-sm" name="{{'distribution ' + field.name}}" ng-model="dealForm.distribution[field.name]" ng-required="{{field.required}}"
                                                uib-tooltip="{{getTooltipMessage(myForm['distribution ' + field.name])}}" tooltip-enable="{{myForm['distribution ' + field.name].$invalid}}">
                                                    <option value="">- select -</option>
                                                    <option ng-repeat="option in field.options" value="{{option}}">{{option}}</option>
                                                </select>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="col-md-6 form-inline">
                        <table class="table table-hover table-condensed">
                            <tbody>
                                <tr ng-repeat="field in fields.distribution track by field.id">
                                    <td ng-if="$odd">
                                        <div class="form-inline" ng-class="{'has-error': myForm['distribution ' + field.name].$invalid}">
                                            <label for="{{field.name}}"> {{field.name}} </label>
                                            <span style="color:red" ng-if="field.required">*</span>
                                            <div ng-if="field.type === 'text' || field.type === 'number' || field.type === 'password' || field.type === 'email'" class="pull-right">
                                                <input type="{{field.type}}" class="form-control input-sm" name="{{'distribution ' + field.name}}" ng-model="dealForm.distribution[field.name]"
                                                    ng-required="{{field.required}}" 
                                                    uib-tooltip="{{getTooltipMessage(myForm['distribution ' + field.name])}}" tooltip-enable="{{myForm['distribution ' + field.name].$invalid}}"/>
                                            </div>
                                            <div ng-if="field.type === 'date'" class="input-group pull-right">
                                                <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['distribution'][field.name]" class="form-control input-sm"
                                                    name="{{'distribution ' + field.name}}" ng-model="dealForm.distribution[field.name]"
                                                    ng-required="{{field.required}}"
                                                    uib-tooltip="{{getTooltipMessage(myForm['distribution ' + field.name])}}" tooltip-enable="{{myForm['distribution ' + field.name].$invalid}}"
                                                    placeholder="{{DATE_FORMAT | uppercase }}">
                                                <span class="input-group-btn">
                                                    <button type="button" class="btn btn-default btn-sm" ng-click="opened['distribution'][field.name] = true">
                                                        <span class="glyphicon glyphicon-calendar"></span>
                                                    </button>
                                                </span>
                                            </div>
                                            <div ng-if="field.type === 'textarea'" class="pull-right">
                                                <!-- show text area -->
                                                <textarea ng-model="dealForm.distribution[field.name]" class="form-control input-sm" name="{{'distribution ' + field.name}}" ng-required="{{field.required}}"
                                                    rows="4" cols="50" uib-tooltip="{{getTooltipMessage(myForm['distribution ' + field.name])}}" tooltip-enable="{{myForm['distribution ' + field.name].$invalid}}"></textarea>
                                            </div>
                                            <div ng-if="field.type ==='dropdown'" class="pull-right">
                                                <!-- show dropdown -->
                                                <select class="form-control input-sm" name="{{'distribution ' + field.name}}" ng-model="dealForm.distribution[field.name]" ng-required="{{field.required}}"
                                                uib-tooltip="{{getTooltipMessage(myForm['distribution ' + field.name])}}" tooltip-enable="{{myForm['distribution ' + field.name].$invalid}}">
                                                    <option value="">- select -</option>
                                                    <option ng-repeat="option in field.options" value="{{option}}">{{option}}</option>
                                                </select>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-1"></div>
    </div>
    <hr class="dealsCollapsible">
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-10">
            <div class="panel-heading">
                <h4 class="accordion-toggle statusSection" data-toggle="collapse" data-parent="#accordion" data-target="#statusSection">
                    <span class="glyphicon glyphicon-chevron-down">&nbsp;</span>Status</h4>
            </div>
            <div id="statusSection" class="collapse in">
                <div class="col-md-6 form-inline">
                    <table class="table table-hover table-condensed">
                        <tbody>
                            <tr>
                                <td>
                                    <label>Dependency</label>
                                    <span style="color:red" ng-if="getField('status', 'Dependency').required">*</span>
                                    <div class="form-group pull-right" ng-class="{'has-error': myForm['status Dependency'].$invalid}">
                                        <!-- /*
                                        * START Francis Nash Jasmin 2022/02/17
                                        * 
                                        * Added character limit of 50 in input text field.
                                        * 
                                        */ -->
                                        <textarea class="form-control input-sm" rows="3" name="status Dependency" ng-model="dealForm.status['Dependency']" ng-required="getField('status', 'Dependency').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['status Dependency'])}}" tooltip-enable="{{myForm['status Dependency'].$invalid}}"
                                        maxlength="50">
                                        </textarea>
                                        <!-- /* END Francis Nash Jasmin 2022/02/17 */ -->
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>Action</label>
                                    <span style="color:red" ng-if="getField('status', 'Action').required">*</span>
                                    <div class="form-group pull-right" ng-class="{'has-error': myForm['status Action'].$invalid}">
                                        <!-- /*
                                        * START Francis Nash Jasmin 2022/02/17
                                        * 
                                        * Added character limit of 50 in input text field.
                                        * 
                                        */ -->
                                        <textarea class="form-control input-sm" rows="3" name="status Action" ng-model="dealForm.status['Action']" ng-required="getField('status', 'Action').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['status Action'])}}" tooltip-enable="{{myForm['status Action'].$invalid}}"
                                        maxlength="50">
                                        </textarea>
                                        <!-- /* END Francis Nash Jasmin 2022/02/17 */ -->
                                    </div>
                                </td>
                            </tr>
                            <tr ng-repeat="field in fields.status track by field.id">
                                <td ng-if="$even && !field.default">
                                    <div class="form-inline" ng-class="{'has-error': myForm['status ' + field.name].$invalid}">
                                        <label for="{{field.name}}"> {{field.name}} </label>
                                        <span style="color:red" ng-if="field.required">*</span>
                                        <div ng-if="field.type === 'text' || field.type === 'number' || field.type === 'password' || field.type === 'email'" class="pull-right">
                                            <input type="{{field.type}}" class="form-control input-sm" name="{{'status ' + field.name}}" ng-model="dealForm.status[field.name]"
                                                ng-required="{{field.required}}" 
                                                uib-tooltip="{{getTooltipMessage(myForm['status ' + field.name])}}" tooltip-enable="{{myForm['status ' + field.name].$invalid}}"/>
                                        </div>
                                        <div ng-if="field.type === 'date'" class="input-group pull-right">
                                            <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['status'][field.name]" class="form-control input-sm" name="{{'status ' + field.name}}"
                                                ng-model="dealForm.status[field.name]" ng-required="{{field.required}}"
                                                uib-tooltip="{{getTooltipMessage(myForm['status ' + field.name])}}" tooltip-enable="{{myForm['status ' + field.name].$invalid}}"
                                                placeholder="{{DATE_FORMAT | uppercase }}">
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default btn-sm" ng-click="opened['status'][field.name] = true">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </button>
                                            </span>
                                        </div>
                                        <div ng-if="field.type === 'textarea'" class="pull-right">
                                            <!-- show text area -->
                                            <textarea ng-model="dealForm.status[field.name]" class="form-control input-sm" name="{{'status ' + field.name}}" ng-required="{{field.required}}"
                                                rows="4" cols="50" uib-tooltip="{{getTooltipMessage(myForm['status ' + field.name])}}" tooltip-enable="{{myForm['status ' + field.name].$invalid}}"></textarea>
                                        </div>
                                        <div ng-if="field.type ==='dropdown'" class="pull-right">
                                            <!-- show dropdown -->
                                            <select class="form-control input-sm" name="{{'status ' + field.name}}" ng-model="dealForm.status[field.name]" ng-required="{{field.required}}"
                                            uib-tooltip="{{getTooltipMessage(myForm['status ' + field.name])}}" tooltip-enable="{{myForm['status ' + field.name].$invalid}}">
                                                <option value="">- select -</option>
                                                <option ng-repeat="option in field.options" value="{{option}}">{{option}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-md-6 form-inline">
                    <table class="table table-hover table-condensed">
                        <tbody>
                            <tr>
                                <td>
                                    <label>Status</label>
                                    <span style="color:red" ng-if="getField('status', 'Status').required">*</span>
                                    <div class="form-group pull-right" ng-class="{'has-error': myForm['status Status'].$invalid}">
                                        <!-- /*
                                        * START Francis Nash Jasmin 2022/02/17
                                        * 
                                        * Added character limit of 50 in input text field.
                                        * 
                                        */ -->
                                        <textarea class="form-control input-sm" rows="3" name="status Status" ng-model="dealForm.status['Status']" ng-required="getField('status', 'Status').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['status Status'])}}" tooltip-enable="{{myForm['status Status'].$invalid}}"
                                        maxlength="50">
                                        </textarea>
                                        <!-- /* END Francis Nash Jasmin 2022/02/17 */ -->
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>Step to Close</label>
                                    <span style="color:red" ng-if="getField('status', 'Step to Close').required">*</span>
                                    <div class="form-group pull-right" ng-class="{'has-error': myForm['status Step to Close'].$invalid}">
                                        <!-- /*
                                        * START Francis Nash Jasmin 2022/02/17
                                        * 
                                        * Added character limit of 50 in input text field.
                                        * 
                                        */ -->
                                        <textarea class="form-control input-sm" rows="3" ng-model="dealForm.status['Step to Close']" name="status Step to Close" ng-required="getField('status', 'Step to Close').required"
                                        uib-tooltip="{{getTooltipMessage(myForm['status Step to Close'])}}" tooltip-enable="{{myForm['status Step to Close'].$invalid}}"
                                        maxlength="50">
                                        </textarea>
                                        <!-- /* END Francis Nash Jasmin 2022/02/17 */ -->
                                    </div>
                                </td>
                            </tr>
                            <tr ng-repeat="field in fields.status track by field.id">
                                <td ng-if="$odd && !field.default">
                                    <div class="form-inline" ng-class="{'has-error': myForm['status ' + field.name].$invalid}">
                                        <label for="{{field.name}}"> {{field.name}} </label>
                                        <span style="color:red" ng-if="field.required">*</span>
                                        <div ng-if="field.type === 'text' || field.type === 'number' || field.type === 'password' || field.type === 'email'" class="pull-right">
                                            <input type="{{field.type}}" class="form-control input-sm" name="{{'status ' + field.name}}" ng-model="dealForm.status[field.name]"
                                                ng-required="{{field.required}}" 
                                                uib-tooltip="{{getTooltipMessage(myForm['status ' + field.name])}}" tooltip-enable="{{myForm['status ' + field.name].$invalid}}"/>
                                        </div>
                                        <div ng-if="field.type === 'date'" class="input-group pull-right">
                                            <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['status'][field.name]" class="form-control input-sm" name="{{'status ' + field.name}}"
                                                ng-model="dealForm.status[field.name]" ng-required="{{field.required}}"
                                                uib-tooltip="{{getTooltipMessage(myForm['status ' + field.name])}}" tooltip-enable="{{myForm['status ' + field.name].$invalid}}"
                                                placeholder="{{DATE_FORMAT | uppercase }}">
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default btn-sm" ng-click="opened['status'][field.name] = true">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </button>
                                            </span>
                                        </div>
                                        <div ng-if="field.type === 'textarea'" class="pull-right">
                                            <!-- show text area -->
                                            <textarea ng-model="dealForm.status[field.name]" class="form-control input-sm" name="{{'status ' + field.name}}" ng-required="{{field.required}}"
                                                rows="4" cols="50" uib-tooltip="{{getTooltipMessage(myForm['status ' + field.name])}}" tooltip-enable="{{myForm['status ' + field.name].$invalid}}"></textarea>
                                        </div>
                                        <div ng-if="field.type ==='dropdown'" class="pull-right">
                                            <!-- show dropdown -->
                                            <select class="form-control input-sm" ng-model="dealForm.status[field.name]" name="{{'status ' + field.name}}" ng-required="{{field.required}}"
                                            uib-tooltip="{{getTooltipMessage(myForm['status ' + field.name])}}" tooltip-enable="{{myForm['status ' + field.name].$invalid}}">
                                                <option value="">- select -</option>
                                                <option ng-repeat="option in field.options" value="{{option}}">{{option}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-md-1"></div>
    </div>
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-10">
            <small>
                <b>Note:</b> 1. If deal is via AWS JP, specify the amount of SOW with AWS JP. If it's a direct deal with client,
                specify the amount of SOW with client exclusive of T&L (to measure the PH revenue and profit)
            </small>
        </div>
        <div class="col-md-1"></div>
    </div>
    </div>
    <hr class="dealsCollapsible">
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-10">
            <div class="panel-heading">
                <h4 class="accordion-toggle contentSection" data-toggle="collapse" data-parent="#accordion" data-target="#contentSection">
                    <span class="glyphicon glyphicon-chevron-down">&nbsp;</span>Content</h4>
            </div>
            <div id="contentSection" class="collapse in">
                <textarea class="form-control input-sm" ng-model="dealForm.content['Main Message']" rows="5"></textarea>
                <div class="col-md-6 form-inline">
                    <table class="table table-hover table-condensed">
                        <tbody>
                            <tr ng-repeat="field in fields.content track by field.id">
                                <td ng-if="$even">
                                    <div class="form-inline" ng-class="{'has-error': myForm['content ' + field.name].$invalid}">
                                        <label for="{{field.name}}"> {{field.name}} </label>
                                        <span style="color:red" ng-if="field.required">*</span>
                                        <div ng-if="field.type === 'text' || field.type === 'number' || field.type === 'password' || field.type === 'email'" class="pull-right">
                                            <input type="{{field.type}}" class="form-control input-sm" name="{{'content ' + field.name}}" ng-model="dealForm.content[field.name]"
                                                ng-required="{{field.required}}" 
                                                uib-tooltip="{{getTooltipMessage(myForm['content ' + field.name])}}" tooltip-enable="{{myForm['content ' + field.name].$invalid}}"
                                                placeholder="{{DATE_FORMAT | uppercase }}">
                                        </div>
                                        <div ng-if="field.type === 'date'" class="input-group pull-right">
                                            <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['content'][field.name]" class="form-control input-sm" name="{{'content ' + field.name}}"
                                                ng-model="dealForm.content[field.name]" ng-required="{{field.required}}"
                                                uib-tooltip="{{getTooltipMessage(myForm['content ' + field.name])}}" tooltip-enable="{{myForm['content ' + field.name].$invalid}}"
                                                placeholder="{{DATE_FORMAT | uppercase }}">
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default btn-sm" ng-click="opened['content'][field.name] = true">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </button>
                                            </span>
                                        </div>
                                        <div ng-if="field.type === 'textarea'" class="pull-right">
                                            <!-- show text area -->
                                            <textarea ng-model="dealForm.content[field.name]" class="form-control input-sm" name="{{'content ' + field.name}}" ng-required="{{field.required}}"
                                                rows="4" cols="50" uib-tooltip="{{getTooltipMessage(myForm['content ' + field.name])}}" tooltip-enable="{{myForm['content ' + field.name].$invalid}}"></textarea>
                                        </div>
                                        <div ng-if="field.type ==='dropdown'" class="pull-right">
                                            <!-- show dropdown -->
                                            <select class="form-control input-sm" ng-model="dealForm.content[field.name]" name="{{'content ' + field.name}}" ng-required="{{field.required}}"
                                            uib-tooltip="{{getTooltipMessage(myForm['content ' + field.name])}}" tooltip-enable="{{myForm['content ' + field.name].$invalid}}">
                                                <option value="">- select -</option>
                                                <option ng-repeat="option in field.options" value="{{option}}">{{option}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-md-6 form-inline">
                    <table class="table table-hover table-condensed">
                        <tbody>
                            <tr ng-repeat="field in fields.content track by field.id">
                                <td ng-if="$odd">
                                    <div class="form-inline" ng-class="{'has-error': myForm['content ' + field.name].$invalid}">
                                        <label for="{{field.name}}"> {{field.name}} </label>
                                        <span style="color:red" ng-if="field.required">*</span>
                                        <div ng-if="field.type === 'text' || field.type === 'number' || field.type === 'password' || field.type === 'email'" class="pull-right">
                                            <input type="{{field.type}}" class="form-control input-sm" name="{{'content ' + field.name}}" ng-model="dealForm.content[field.name]"
                                                ng-required="{{field.required}}" 
                                                uib-tooltip="{{getTooltipMessage(myForm['content ' + field.name])}}" tooltip-enable="{{myForm['content ' + field.name].$invalid}}"/>
                                        </div>
                                        <div ng-if="field.type === 'date'">
                                            <div class="input-group pull-right">
                                                <input type="text" uib-datepicker-popup="{{DATE_FORMAT}}" is-open="opened['content'][field.name]" class="form-control input-sm" name="{{'content ' + field.name}}"
                                                    ng-model="dealForm.content[field.name]" ng-required="{{field.required}}"
                                                    uib-tooltip="{{getTooltipMessage(myForm['content ' + field.name])}}" tooltip-enable="{{myForm['content ' + field.name].$invalid}}"
                                                    placeholder="{{DATE_FORMAT | uppercase }}">
                                                <span class="input-group-btn">
                                                    <button type="button" class="btn btn-default btn-sm" ng-click="opened['content'][field.name] = true">
                                                        <span class="glyphicon glyphicon-calendar"></span>
                                                    </button>
                                                </span>
                                            </div>
                                        </div>
                                        <div ng-if="field.type === 'textarea'" class="pull-right">
                                            <!-- show text area -->
                                            <textarea ng-model="dealForm.content[field.name]" class="form-control input-sm" name="{{'content ' + field.name}}" ng-required="{{field.required}}"
                                                rows="4" cols="50"
                                                uib-tooltip="{{getTooltipMessage(myForm['content ' + field.name])}}" tooltip-enable="{{myForm['content ' + field.name].$invalid}}">
                                            </textarea>
                                        </div>
                                        <div ng-if="field.type ==='dropdown'" class="pull-right">
                                            <!-- show dropdown -->
                                            <select class="form-control input-sm" name="{{'content ' + field.name}}" ng-model="dealForm.content[field.name]" ng-required="{{field.required}}"
                                            uib-tooltip="{{getTooltipMessage(myForm['content ' + field.name])}}" tooltip-enable="{{myForm['content ' + field.name].$invalid}}">
                                                <option value="">- select -</option>
                                                <option ng-repeat="option in field.options" value="{{option}}">{{option}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-md-1"></div>
    </div>
    <!-- /*
    * START Francis Nash Jasmin 2022/03/09
    * 
    * Added attachments for a new or existing deal.
    * 
    */ -->
    <hr class="dealsCollapsible">
    <div class="row" ng-show="showAttachmentForm">
        <div class="col-md-1"></div>
        <div class="col-md-10">
            <div class="panel-heading">
                <h4 class="accordion-toggle attachmentsSection">
                    <span class="glyphicon glyphicon-chevron-down" data-toggle="collapse" data-parent="#accordion" data-target="#attachmentsSection">&nbsp;</span>Attachments
                    
                    <button style="float: right;" type="button" class="btn btn-default btn-sm" ng-click="openModal()">
                        <span class="glyphicon glyphicon-plus"></span>
                    </button>
                </h4>
            </div>
            <div id="attachmentsSection" class="collapse in">
                <table class="table table-hover normal-table table-striped">
                    <thead id="header-fixed">
                        <th>
                            <div>File Name</div>
                        </th>
                        <th>
                            <div>Description</div>
                        </th>
                        <th></th>
                    </thead>
                    <tbody>
                        <tr ng-repeat="attachment in dealForm.attachments">
                            <td>{{attachment.fileName.split(' ').slice(1).join(' ')}}</td>
                            <td>{{(attachment.description === 'null' || attachment.description === null) ? 'No description' : attachment.description}}</td>

                            <td class="tools">
                                <a ng-hide="dealForm.ID === undefined"><i class="fa fa-download" aria-hidden="true" data-toggle="tooltip" title="Download" ng-click="downloadFile(attachment.fileName)"></i></a>
                                &nbsp;
                                <!-- Delete from directory and database -->
                                <a><i class="fa fa-trash" aria-hidden="true" data-toggle="tooltip" title="Delete" ng-click="deleteFile(attachment.fileName)"></i></a>
                            </td>
                            <td ng-hide="true">{{attachment.directory}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="col-md-1"></div>
    </div>
    <!-- /*  END Francis Nash Jasmin 2022/03/18 */ -->
    <!-- CHANGE HISTORY -->
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-10">
            <u>Change History:</u>
            <div ng-repeat="change in dealForm['Change History']">
                {{change.date}}, {{change.user}}, {{change.content}}
                <br/>
            </div>
            <table class="table table-hover table-condensed">
                <thead>
                    <th>LEVEL</th>
                    <th>DATE</th>
                </thead>
                <tbody>
                    <tr>
                        <td>Level 5</td>
                        <td>{{getLatestChangeDate('5')}}</td>
                    </tr>
                    <tr>
                        <td>Level 4</td>
                        <td>{{getLatestChangeDate('4')}}</td>
                    </tr>
                    <tr>
                        <td>Level 3</td>
                        <td>{{getLatestChangeDate('3')}}</td>
                    </tr>
                    <tr>
                        <td>Level 2</td>
                        <td>{{getLatestChangeDate('2')}}</td>
                    </tr>
                    <tr>
                        <td>Level 1</td>
                        <td>{{getLatestChangeDate('1')}}</td>
                    </tr>
                    <tr>
                        <td>Level 9</td>
                        <td>{{getLatestChangeDate('9')}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="col-md-1"></div>
    </div>
</form>

<script>
    $('.collapse').on('shown.bs.collapse', function () {
        $(this).parent().find(".glyphicon-chevron-right").removeClass("glyphicon-chevron-right").addClass("glyphicon-chevron-down");
    }).on('hidden.bs.collapse', function () {
        $(this).parent().find(".glyphicon-chevron-down").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-right");
    });
</script>